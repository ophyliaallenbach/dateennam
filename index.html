<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8">
    <title>Id√©es de sorties ‚òî</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ü•∞</text></svg>">
    
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>

    <style>
      /* PALETTE "PLUIE DE JUIN" */
      :root { --misty-violet: #5f5baf; --rainy-blue: #568de4; --rain-purple: #ba9fe1; --deep-iris: #9a64c5; --cloudy-lilac: #c4c5e8; --white: #ffffff; }
      body { font-family: 'Segoe UI', sans-serif; background-color: var(--cloudy-lilac); color: var(--misty-violet); text-align: center; margin: 0; padding: 20px; background-image: linear-gradient(to bottom, #c4c5e8 0%, #dce0f5 100%); min-height: 100vh; }
      
      h1 { color: var(--misty-violet); margin-top: 100px; font-size: 2.5em; text-shadow: 2px 2px 0px rgba(255,255,255,0.4); }
      .phrase { font-style: italic; color: var(--deep-iris); margin-bottom: 30px; font-weight: 500; }
      
      /* --- MENU UNIVERSEL --- */
      .top-nav { position: fixed; top: 10px; right: 10px; display: flex; flex-wrap: wrap; gap: 8px; z-index: 1000; background: rgba(255,255,255,0.6); padding: 8px; border-radius: 15px; backdrop-filter: blur(5px); justify-content: flex-end; }
      .btn-nav, .btn-logout { border: none; padding: 8px 12px; border-radius: 15px; cursor: pointer; font-weight: bold; box-shadow: 0 4px 10px rgba(95, 91, 175, 0.1); transition: 0.3s; text-decoration: none; font-size: 0.85em; display: flex; align-items: center; justify-content: center; }
      /* Couleurs du menu adapt√©es au th√®me Violet */
      .btn-nav { background: var(--misty-violet); color: var(--white); }
      .btn-nav:hover { background: var(--deep-iris); transform: translateY(-2px); }
      .btn-logout { background: #90a4ae; color: white; }
      .btn-logout:hover { background: #78909c; }

      /* Le reste du style reste identique */
      .input-zone { background: var(--white); padding: 25px; border-radius: 20px; max-width: 600px; margin: 0 auto 40px auto; box-shadow: 0 10px 25px rgba(95, 91, 175, 0.15); border: 2px solid var(--rain-purple); }
      input[type="text"], input[type="number"], input[type="date"] { padding: 12px; border-radius: 12px; margin-top: 10px; border: 1px solid var(--rain-purple); width: 90%; font-family: inherit; color: var(--misty-violet); background: #fcfaff; }
      input:focus { outline: none; border-color: var(--rainy-blue); background: #fff; }
      #categories { margin-top: 15px; display: flex; flex-wrap: wrap; justify-content: center; gap: 10px; }
      #categories label { font-size: 0.9em; cursor: pointer; background: var(--cloudy-lilac); padding: 5px 10px; border-radius: 15px; color: var(--misty-violet); transition: 0.2s; border: 1px solid transparent; }
      #categories label:hover { background: var(--rain-purple); color: white; }
      #categories input { margin-right: 5px; accent-color: var(--misty-violet); }
      button.add { background: var(--rainy-blue); color: var(--white); cursor: pointer; border: none; padding: 12px 30px; border-radius: 12px; margin-top: 20px; font-size: 16px; font-weight: bold; width: 100%; max-width: 300px; transition: transform 0.2s, background 0.2s; box-shadow: 0 5px 15px rgba(86, 141, 228, 0.3); }
      button.add:hover { background: var(--misty-violet); transform: translateY(-2px); }
      #sorties { margin-top: 20px; display: flex; flex-wrap: wrap; justify-content: center; gap: 20px; padding-bottom: 50px; }
      .carte { background: var(--white); width: 260px; padding: 20px; border-radius: 20px; box-shadow: 0 8px 20px rgba(95, 91, 175, 0.1); text-align: left; transition: transform 0.2s; position: relative; border-top: 5px solid var(--rainy-blue); }
      .carte:hover { transform: translateY(-5px); }
      .carte h3 { margin: 0 0 10px 0; color: var(--misty-violet); font-size: 1.3em; }
      .carte p { color: #666; line-height: 1.5; font-size: 0.95em; margin: 5px 0; }
      .badge-cat { font-size: 0.8em; background: var(--cloudy-lilac); padding: 3px 8px; border-radius: 10px; color: var(--misty-violet); font-weight: bold; }
      .btn-delete { background: #ffcdd2; color: #c62828; border: none; padding: 6px 12px; border-radius: 8px; cursor: pointer; margin-top: 15px; font-size: 12px; font-weight: bold; float: right; transition: 0.2s; }
      .btn-delete:hover { background: #ef9a9a; }
    </style>
  </head>
  <body>
    <div class="top-nav">
        <a href="musees.html" class="btn-nav">üèõÔ∏è Mus√©es</a>
        <a href="sorties.html" class="btn-nav">üé≠ Spectacles</a>
        <button class="btn-logout" onclick="localStorage.removeItem('estConnecte'); window.location.href='login.html';">üîí</button>
    </div>

    <h1>Id√©es de sorties ‚òî</h1>
    <div class="phrase">Pour nos moments √† nous...</div>

    <div class="input-zone">
      <input type="text" id="nouvelleIdee" placeholder="‚ú® Propose une id√©e..." />
      <div id="categories">
        <label><input type="checkbox" value="Resto"> üçú Resto</label>
        <label><input type="checkbox" value="Cin√©"> üçø Cin√©</label>
        <label><input type="checkbox" value="Balade"> üå≥ Balade</label>
        <label><input type="checkbox" value="Maison"> üè† Maison</label>
        <label><input type="checkbox" value="Activit√©"> üé® Activit√©</label>
        <label><input type="checkbox" value="Surprise"> üéÅ Surprise</label>
      </div>
      <div style="display:flex; gap:10px;">
          <input type="date" id="dateIdee" title="Date pr√©vue" />
          <input type="number" id="prixIdee" placeholder="Prix (‚Ç¨)" />
      </div>
      <input type="text" id="lieuIdee" placeholder="üìç Lieu (ex: Paris...)" />
      <button class="add" onclick="ajouterIdee()">Ajouter √† la liste</button>
    </div>

    <div id="sorties">Chargement...</div>

    <script>
        const firebaseConfig = { apiKey: "AIzaSyD9bzSuQY8CR9RVnQMu6WI4plznzQrfBC4", authDomain: "date-d927b.firebaseapp.com", projectId: "date-d927b", storageBucket: "date-d927b.appspot.com", messagingSenderId: "353304192798", appId: "1:353304192798:web:1511fa87bfbf11bdda0b0f", measurementId: "G-T4N8PMNC3G" };
        if (typeof firebase !== 'undefined' && !firebase.apps.length) { firebase.initializeApp(firebaseConfig); }
        let db; try { db = firebase.firestore(); } catch (e) { console.error("Erreur:", e); }
        function chargerIdees() { const container = document.getElementById('sorties'); db.collection("dates").orderBy("timestamp", "desc").onSnapshot((snapshot) => { container.innerHTML = ""; if(snapshot.empty) { container.innerHTML = "<p style='color:var(--misty-violet); font-style:italic;'>Pas encore d'id√©es... Lance-toi ! ‚ú®</p>"; return; } snapshot.forEach((doc) => { const data = doc.data(); const id = doc.id; const nom = data.texte || data.nom || "Id√©e myst√®re"; const cats = data.categories ? data.categories.join(" ") : ""; const prix = data.prix ? `${data.prix}‚Ç¨` : ""; const date = data.date ? `üìÖ ${data.date}` : ""; const lieu = data.lieu ? `üìç ${data.lieu}` : ""; const carte = document.createElement("div"); carte.className = "carte"; carte.innerHTML = `<h3>${nom}</h3><p>${cats ? `<span class="badge-cat">${cats}</span>` : ""}</p><p>${lieu} ${prix ? `| üí∏ ${prix}` : ""}</p><p style="color:var(--rainy-blue); font-weight:bold;">${date}</p><button class="btn-delete" onclick="supprimerIdee('${id}')">Supprimer</button>`; container.appendChild(carte); }); }); }
        function ajouterIdee() { const texte = document.getElementById("nouvelleIdee").value; const date = document.getElementById("dateIdee").value; const prix = document.getElementById("prixIdee").value; const lieu = document.getElementById("lieuIdee").value; const checkboxes = document.querySelectorAll('#categories input:checked'); let categories = []; checkboxes.forEach((checkbox) => { categories.push(checkbox.value); }); if (texte === "") { alert("√âcris quelque chose !"); return; } db.collection("dates").add({ texte: texte, categories: categories, date: date, prix: prix, lieu: lieu, timestamp: firebase.firestore.FieldValue.serverTimestamp() }).then(() => { document.getElementById("nouvelleIdee").value = ""; document.getElementById("dateIdee").value = ""; document.getElementById("prixIdee").value = ""; document.getElementById("lieuIdee").value = ""; checkboxes.forEach(cb => cb.checked = false); }).catch((error) => { console.error("Erreur : ", error); }); }
        function supprimerIdee(id) { if(confirm("Supprimer cette id√©e ?")) { db.collection("dates").doc(id).delete(); } }
        document.addEventListener('DOMContentLoaded', () => { chargerIdees(); });
    </script>
  </body>
</html>
